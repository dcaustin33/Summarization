Starting from step 0
Training for 20000 steps
10 18.94021701812744
20 35.23361158370972
30 51.424169301986694
40 67.8614809513092
50 84.19367599487305
60 100.76026058197021
70 117.39506196975708
80 134.0552704334259
90 150.3782799243927
100 Loss: 428.45
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
100 166.68295574188232
110 183.19196391105652
120 199.6171178817749
130 215.97262287139893
140 232.55427956581116
150 248.98512721061707
160 265.5925130844116
170 282.30466532707214
180 298.6311056613922
190 314.8415083885193
200 Loss: 401.07
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
200 331.2202253341675
210 347.6017243862152
220 363.78915786743164
230 380.4336483478546
240 396.5618336200714
250 413.48768639564514
260 429.73796677589417
270 446.0545177459717
280 462.8698136806488
290 479.3295931816101
300 Loss: 394.92
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
300 495.7717671394348
310 512.223016500473
320 528.800300359726
330 545.5613005161285
340 561.8129222393036
350 578.0707104206085
360 594.6879498958588
370 611.3580710887909
380 627.8242411613464
390 643.8879086971283
400 Loss: 392.54
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
400 660.5718982219696
410 677.0470368862152
420 693.3585252761841
430 709.7207415103912
440 726.0363004207611
450 742.6461789608002
460 758.9739100933075
470 775.4743096828461
480 791.747415304184
490 808.7524785995483
500 Loss: 366.28
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
500 825.1791734695435
510 841.4481301307678
520 857.8336243629456
530 874.1244525909424
540 891.0795929431915
550 907.4882621765137
560 924.430890083313
570 940.8201150894165
580 957.4735097885132
590 974.2519776821136
600 Loss: 334.94
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
600 991.1175646781921
610 1007.2470088005066
620 1023.4367942810059
630 1039.654771566391
640 1056.0153131484985
650 1072.9881086349487
660 1089.2670805454254
670 1105.857827425003
680 1122.1971306800842
690 1138.7225580215454
700 Loss: 237.68
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
700 1155.4299387931824
710 1171.9446082115173
720 1188.3628120422363
730 1204.7343573570251
740 1220.908953666687
750 1237.1756715774536
760 1253.7994000911713
770 1270.1916618347168
780 1286.6412258148193
790 1303.2461686134338
800 Loss: 160.02
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
800 1319.7584400177002
810 1336.1178758144379
820 1352.8385927677155
830 1369.1731839179993
840 1385.595675945282
850 1402.0653505325317
860 1418.3842568397522
870 1435.0928103923798
880 1451.9345569610596
890 1468.348244190216
900 Loss: 135.81
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
900 1484.7647233009338
910 1501.4428033828735
920 1518.0674653053284
930 1534.3619425296783
940 1550.5991604328156
950 1566.732278585434
960 1583.2418792247772
970 1599.5571596622467
980 1615.98801279068
990 1632.5965700149536
1000 Loss: 128.65
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1000 1648.9096398353577
/opt/conda/lib/python3.7/site-packages/transformers/generation_utils.py:1301: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 128 (`self.config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  UserWarning,
out val
1010 1723.1075468063354
1020 1739.3333251476288
1030 1755.6004197597504
1040 1771.8819382190704
1050 1788.1028175354004
1060 1804.4503195285797
1070 1820.9016637802124

1080 1837.1897768974304
1090 1853.4778366088867
1100 Loss: 128.38
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1100 1869.8344836235046
1110 1886.2292475700378
1120 1903.0941035747528
1130 1919.6062817573547
1140 1935.8712682724
1150 1952.2819991111755
1160 1968.717256307602
1170 1985.0378561019897
1180 2001.2554214000702
1190 2018.112476825714
1200 Loss: 124.64
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1200 2034.4908390045166
1210 2050.8698885440826
1220 2067.7523782253265
1230 2084.3272836208344
1240 2100.7593014240265
1250 2117.159403562546

1260 2133.566556930542
1270 2149.7500228881836
1280 2166.0805559158325
1290 2182.7520921230316
1300 Loss: 126.62
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1300 2199.0917456150055
1310 2215.3961198329926
1320 2231.7784407138824
1330 2248.0178360939026
1340 2264.563353061676
1350 2280.867052793503
1360 2296.98109292984
1370 2313.805017232895
1380 2330.2351694107056
1390 2347.223525762558
1400 Loss: 123.43
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1400 2363.633547782898
1410 2380.0426831245422
1420 2396.3601908683777
1430 2412.6741976737976
1440 2429.333113670349
1450 2445.419275522232
1460 2462.042403936386
1470 2478.3670756816864
1480 2494.5427238941193
1490 2510.8940913677216
1500 Loss: 125.47
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1500 2527.273708343506
1510 2543.7916016578674
1520 2560.4295077323914
1530 2576.9245042800903
1540 2593.387309551239
1550 2609.7071030139923
1560 2626.265134572983
1570 2642.568675994873
1580 2658.955595254898
1590 2675.515976190567
1600 Loss: 124.36
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1600 2691.9705913066864
1610 2708.4019179344177
1620 2725.0960137844086
1630 2741.3445103168488
1640 2757.859673976898
1650 2774.1529397964478
1660 2790.4980607032776
1670 2806.836915254593
1680 2823.19052362442
1690 2839.5199291706085
1700 Loss: 119.41
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1700 2855.8882400989532
1710 2872.1583585739136
1720 2888.362518787384
1730 2904.612151145935
1740 2921.2387976646423
1750 2937.574141025543
1760 2953.871985912323
1770 2970.304183483124
1780 2986.6255447864532
1790 3002.8502929210663
1800 Loss: 124.96
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1800 3019.354698896408
1810 3035.3807237148285
1820 3051.7025578022003
1830 3068.06666636467
1840 3084.0737857818604
1850 3100.8708465099335
1860 3117.0692615509033
1870 3133.502359867096
1880 3149.6990971565247
1890 3166.1520187854767
1900 Loss: 125.18
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
1900 3182.4401454925537
1910 3199.0440249443054
1920 3215.4332361221313
1930 3232.0869698524475
1940 3248.630834579468
1950 3264.9861080646515
1960 3281.251499414444
1970 3297.6867983341217
1980 3313.834442138672
1990 3330.366928100586
2000 Loss: 122.81
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2000 3346.918207883835
out val
2010 3433.875871658325
2020 3450.2103803157806
2030 3466.6030027866364
2040 3482.889391899109
2050 3499.6176965236664
2060 3516.366974592209
2070 3532.724091053009
2080 3548.9945142269135
2090 3565.1105167865753
2100 Loss: 122.93
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2100 3581.8225197792053
2110 3598.736439704895

2120 3615.309545993805
2130 3631.6441445350647
2140 3647.839965581894
2150 3664.0977296829224
2160 3680.364929676056
2170 3696.8776829242706

2180 3713.442776441574
2190 3729.676589012146
2200 Loss: 123.85
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2200 3746.831265926361
2210 3763.1870682239532
2220 3779.6414272785187
2230 3795.9569895267487
2240 3812.1359639167786
2250 3828.852229118347
2260 3845.1062936782837
2270 3861.474035024643
2280 3877.986312866211
2290 3894.154682159424
2300 Loss: 123.11
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2300 3910.9567441940308
2310 3927.356675863266
2320 3943.6664130687714
2330 3960.1338336467743
2340 3976.532771587372
2350 3993.3467037677765
2360 4009.672414302826
2370 4026.0411615371704
2380 4042.968493938446
2390 4059.697615146637
2400 Loss: 125.94
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2400 4076.1061742305756
2410 4092.45694231987
2420 4108.910281896591
2430 4125.202001333237
2440 4141.508010625839
2450 4158.129168748856
2460 4174.575396776199
2470 4191.037782669067
2480 4207.240969181061
2490 4223.787861824036
2500 Loss: 122.59
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2500 4240.477278709412
2510 4257.42834186554
2520 4273.920915365219
2530 4290.452961683273
2540 4306.6738522052765
2550 4323.004243373871
2560 4339.210479736328
2570 4355.517310857773
2580 4372.455038547516
2590 4389.079185009003
2600 Loss: 122.0
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2600 4406.045388698578
2610 4422.143068313599
2620 4438.821837186813
2630 4455.251374959946
2640 4471.707575082779
2650 4487.852566957474
2660 4504.154058218002
2670 4520.634473323822
2680 4536.913694858551
2690 4553.066865205765
2700 Loss: 123.04
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2700 4569.306149721146
2710 4585.450613737106
2720 4601.788658618927
2730 4617.828240871429
2740 4634.010455608368
2750 4650.19345664978
2760 4666.671224594116
2770 4682.83714389801
2780 4698.8831696510315
2790 4715.216993093491
2800 Loss: 126.3
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2800 4732.251836299896
2810 4748.557543992996
2820 4765.1891412734985
2830 4781.517016887665
2840 4797.9072279930115
2850 4815.112318992615
2860 4831.510999679565
2870 4847.793761968613
2880 4864.531171321869
2890 4881.0601127147675
2900 Loss: 123.36
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
2900 4897.686618089676
2910 4914.302383899689
2920 4930.9687304496765
2930 4947.4313979148865
2940 4963.8165900707245
2950 4980.275761842728
2960 4996.784718751907
2970 5013.42595410347
2980 5029.6379137039185
2990 5046.003165483475
3000 Loss: 117.81
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3000 5062.397375583649
out val
3010 5148.745730400085
3020 5165.317332267761
3030 5181.857674360275
3040 5198.62370967865
3050 5215.092592716217
3060 5231.631995677948
3070 5247.837089300156
3080 5264.148616552353
3090 5280.800809621811
3100 Loss: 122.08
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3100 5297.375717163086
3110 5313.899534463882
3120 5330.408458471298
3130 5346.895660161972
3140 5363.46501660347
3150 5380.062114953995
3160 5397.0599546432495
3170 5413.593762874603
3180 5430.133908510208
3190 5446.562691926956
3200 Loss: 119.2
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3200 5463.358931064606
3210 5479.739980697632
3220 5496.0190308094025
3230 5512.69867682457
3240 5529.292986631393
3250 5545.656502008438
3260 5562.322463750839
3270 5578.787880659103
3280 5595.25950050354
3290 5611.7552485466
3300 Loss: 119.15
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3300 5628.252639293671
3310 5644.788177728653
3320 5661.550798654556
3330 5678.411778211594
3340 5694.731278896332
3350 5711.006738901138
3360 5727.358268260956
3370 5744.112113952637
3380 5760.645089864731
3390 5777.482200622559
3400 Loss: 121.9
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3400 5794.036370277405
3410 5810.746671199799
3420 5827.417533874512
3430 5843.892544269562
3440 5860.42777633667
3450 5876.79834151268
3460 5893.358399391174
3470 5909.977365732193

3480 5926.04311466217
3490 5942.11371922493
3500 Loss: 120.96
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3500 5958.703280210495
3510 5975.298527002335
3520 5991.617449998856

3530 6008.169407129288
3540 6025.092529058456
3550 6041.479929924011

3560 6057.718203783035
3570 6074.173469543457
3580 6090.592748641968
3590 6107.061790943146
3600 Loss: 124.7
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3600 6123.350553274155
3610 6139.7495539188385
3620 6156.033322811127
3630 6172.614707946777
3640 6188.995884180069
3650 6205.233138561249
3660 6221.701562404633
3670 6238.073457956314
3680 6254.356966495514
3690 6270.590107917786
3700 Loss: 123.38
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3700 6287.084903717041
3710 6303.475084066391
3720 6319.758922815323
3730 6336.130287885666
3740 6352.377680540085
3750 6368.47012925148
3760 6384.99772310257
3770 6401.503876686096
3780 6417.876155376434
3790 6434.29892373085
3800 Loss: 126.13
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3800 6450.596585988998
3810 6466.948917627335
3820 6483.528840780258
3830 6499.702013254166
3840 6516.055009841919
3850 6532.140544652939
3860 6548.508416175842
3870 6564.998953580856
3880 6581.348705291748
3890 6597.593146324158
3900 Loss: 123.2
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
3900 6614.011324644089

3910 6630.406436681747
3920 6646.822734117508
3930 6663.071421146393
3940 6679.560621500015
3950 6695.7557373046875
3960 6712.740026950836
3970 6728.948960065842
3980 6745.1781713962555
3990 6761.836292505264
4000 Loss: 120.1
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
4000 6778.215521097183
out val
4010 6864.233037948608
4020 6880.605122566223
4030 6897.100795984268
4040 6913.3725345134735
4050 6929.604801893234
4060 6945.932364702225
4070 6962.208107471466
4080 6978.472013235092
4090 6994.979328870773
4100 Loss: 120.69
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
4100 7011.833463907242
4110 7028.310708284378
4120 7044.468893527985
4130 7061.175891160965
4140 7077.417865991592
4150 7093.520985364914
4160 7110.058117389679
4170 7126.449572324753
4180 7142.889019489288
4190 7159.216967344284
4200 Loss: 121.46
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
4200 7175.913217544556
4210 7192.356269598007
4220 7208.799731492996
4230 7225.43102145195
4240 7241.805899858475
4250 7258.228045940399
4260 7274.544634103775
4270 7290.8363399505615
4280 7307.553684949875
4290 7323.805091619492
4300 Loss: 127.02
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
4300 7340.27516579628
4310 7356.505320310593
4320 7372.808025360107
4330 7389.179422855377
4340 7405.693267583847
4350 7421.945761442184
4360 7438.41726064682
4370 7454.9095277786255

4380 7471.404427528381
4390 7488.0951681137085
4400 Loss: 121.9
In Logging <wandb.sdk.wandb_run.Run object at 0x7fca01be51d0>
logging
4400 7504.83548617363
4410 7520.895072698593
4420 7537.171298027039
4430 7553.818435668945
4440 7570.251199960709
Traceback (most recent call last):
  File "train_xsum.py", line 179, in <module>
    trainer.train()
  File "/home/da2986/Summarization/src/training_scripts/trainer.py", line 80, in train
    loss = self.training_step(data, self.model, self.metrics, steps, log = False, wandb = self.wandb, args = self.args)
  File "train_xsum.py", line 48, in training_step
    out =  model(input_ids = data['article']['input_ids'], labels = data['summary']['input_ids'], attention_mask = data['article']['attention_mask'])
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/transformers/models/pegasus/modeling_pegasus.py", line 1416, in forward
    return_dict=return_dict,
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/transformers/models/pegasus/modeling_pegasus.py", line 1270, in forward
    return_dict=return_dict,
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/transformers/models/pegasus/modeling_pegasus.py", line 1103, in forward
    use_cache=use_cache,
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/transformers/models/pegasus/modeling_pegasus.py", line 450, in forward
    output_attentions=output_attentions,
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/transformers/models/pegasus/modeling_pegasus.py", line 195, in forward
    query_states = self.q_proj(hidden_states) * self.scaling
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
KeyboardInterrupt